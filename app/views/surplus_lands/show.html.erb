<% provide(:title, @surplus_land.title) %>

<%= render 'shared/page_title', page_title: @surplus_land.title %>

<div class="row">
  <div class="col-md-6"> <!-- image -->
    <ul class="slider-for">
      <% @surplus_land.images.each do |image| %>
        <li class="image-box"><%= image_tag image, class: 'image' %></li>
      <% end %>
    </ul>
    <ul class="slider-nav">
      <% @surplus_land.images.each do |image| %>
        <li class="thumb-list"><%= image_tag image, class: 'image' %></li>
      <% end %>
    </ul>
  </div>
  <div class="col-md-6"> <!-- description -->
    <!-- 申し込みフォーム -->
    <% if user_signed_in? && @surplus_land.user != current_user %>
      <% if room = find_room(@surplus_land, current_user) %>
        <button class="btn btn-default">
          <%= link_to 'もう一度申し込む', room %>
        </button>
      <% else %>
        <%= form_for @surplus_land.rooms.build do |f| %>
          <%= hidden_field_tag :surplus_land_id, @surplus_land.id %>
          <%= f.submit '申し込む', class: 'btn btn-default' %>
        <% end %>
      <% end %>
    <% elsif user_signed_in? && @surplus_land.user == current_user %> <!-- 通知を作るまでのつなぎとしてOwner側からのルームへのリンク表示 -->
      <% if @surplus_land.rooms.any? %>
        <% @surplus_land.rooms.each do |room| %>
          <%= link_to "#{room.visitor.name}とのルーム", room %>
        <% end %>
      <% end %>
    <% end %>

    <h4><span class="glyphicon glyphicon-user" aria-hidden="true"></span> 管理人</h4>
    <p><%= link_to @surplus_land.user.name, @surplus_land.user %></p>
    <h4><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> エリア</h4>
    <p><%= @surplus_land.state %></p>
    <h4><span class="glyphicon glyphicon-usd" aria-hidden="true"></span> 価格</h4>
    <p><%= @surplus_land.price %> 円</p>
    <h4><span class="glyphicon glyphicon-home" aria-hidden="true"></span> 所在地</h4>
    <p><%= @surplus_land.address %></p>
  </div>
</div>

<div class="description">
  <h4><span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span> キャンプ地紹介</h4>
  <p><%= @surplus_land.description %></p>
</div>
<%= link_to '編集する', edit_surplus_land_path(@surplus_land) if current_user?(@surplus_land.user) %>

<div class="comment">
  <h3>コメント</h3>
  <div class="row"> <!-- comment -->
    <div class="col-md-7" id="surplus_land_comments"> <!-- comment 表示 -->
      <%= render @comments, surplus_land: @surplus_land %>
    </div>
    <div class="col-md-5"> <!-- comment form -->
      <%= form_for @comment, url: surplus_land_comments_path(@surplus_land), remote: true do |f| %>
        <div id="error_messages">
          <%= render "users/shared/error_messages", resource: @comment %>
        </div>
        <div class="form-group">
          <%= f.text_area :body, class: 'form-control', id: 'comment_body' %>
        </div>
        <div class="form-group">
          <%= f.submit 'コメントする', class: 'btn btn-default form-control' %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="google-map" id="map"></div> <!-- google map api -->

<%= render 'shared/maps_script', hash: @hash %>
